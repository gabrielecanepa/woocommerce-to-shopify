<div align="center">
  <picture>
    <source media="(prefers-color-scheme: light)" srcset=".github/static/logo.png" width="220">
    <source media="(prefers-color-scheme: dark)" srcset=".github/static/logo-dark.png" width="220">
    <img src=".github/static/logo.png" width="220">
  </picture>
  <h1>WooCommerce to Shopify</h1>
  <img src="https://img.shields.io/github/package-json/v/gabrielecanepa/woocommerce-to-shopify?style=flat&logo=woo&logoColor=white&labelColor=%23272d33&color=%237f54b2">
  <a href="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/sync.yml">
    <img src="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/sync.yml/badge.svg" />
  </a>
  <a href="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/code-quality.yml">
    <img src="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/code-quality.yml/badge.svg" />
  </a>
  <a href="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/github-code-scanning/codeql">
    <img src="https://github.com/gabrielecanepa/woocommerce-to-shopify/actions/workflows/github-code-scanning/codeql/badge.svg" />
  </a>
</div>
<br>

Script and GitHub Actions workflow to import products and collections from WooCommerce to Shopify.

## Prerequisites

You must download and activate the Node.js version specified in `.node-version`.

## Setup

Clone the project or [use it as a template](https://github.com/new?template_name=woocommerce-to-shopify&template_owner=gabrielecanepa):

```sh
gh repo clone gabrielecanepa/woocommerce-to-shopify
# or
git clone https://github.com/gabrielecanepa/woocommerce-to-shopify.git
```

Activate pnpm using Corepack, install the dependencies and build the project:

```sh
corepack enable
corepack install
pnpm install
pnpm build
```

### Environment variables

Copy the `.env.example` file to `.env` and fill in the necessary environment variables.

You can generate the Shopify access token by [creating a private app](https://shopify.dev/tutorials/authenticate-a-private-app-with-shopify-admin#generate-credentials-from-the-shopify-admin) in your Shopify store.

The WooCommerce consumer key and secret can be generated by [creating a REST API key](https://docs.woocommerce.com/document/woocommerce-rest-api/) in your WordPress dashboard.

## Running the script

### Locally

Run the script with either:

```sh
# Production mode
pnpm sync
# Development mode using tsx
pnpm sync:dev
```

### GitHub Actions

To run the [`sync` workflow](.github/workflows/sync.yml), you need to set the following in your GitHub Actions repository settings.

Secrets:

- `SHOPIFY_ACCESS_TOKEN`
- `WOOCOMMERCE_CONSUMER_KEY`
- `WOOCOMMERCE_CONSUMER_SECRET`

Variables:

- `SHOPIFY_SHOP_NAME`
- `WOOCOMMERCE_URL`

The workflow is configured to run every 5 minutes (GitHub's limit for scheduled workflows) and can be triggered:

- With a `workflow_dispatch` event
- With a `repository_dispatch` event via the GitHub API:

  ```sh
  curl --request POST \
    --url 'https://api.github.com/repos/<repo>/dispatches' \
    --header 'authorization: Bearer <GITHUB_ACCESS_TOKEN>' \
    --data '{ "event_type": "sync" }'
  ```
